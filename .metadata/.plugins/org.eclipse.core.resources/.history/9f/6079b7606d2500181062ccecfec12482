package actividad1.servicios;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.mysql.jdbc.Statement;

import actividad1.domain.Propietarios;

public class PropietariosService {
	
	Connection conn=null;
	
	public PropietariosService(Connection conn) {
		super();
		this.conn = conn;
	}
	

	public void insertarPropietario(Propietarios propietario) {
		try {
			String query ="INSERT INTO propietarios VALUES (?,?,?,?,?,?)";
			PreparedStatement pst1= conn.prepareStatement(query);
			pst1.setString(1,propietario.getDni());
			pst1.setString(2,propietario.getUsuario());
			pst1.setString(3, propietario.getNombre());
			pst1.setString(4,propietario.getPrimerapellido() );
			pst1.setString(5, propietario.getSegundoapellido());
			pst1.setString(6,propietario.getNumerosecreto() );
			
			pst1.executeUpdate();
			pst1.close();
			
		}
		catch(SQLException ex) {
			
			System.out.println("Error: al ingresar un nuevo propietario");
			ex.printStackTrace();
			
		}
	}

	public void modificarPropietario(Propietarios propietario) throws SQLException {
		String query= "UPDATE propietarios set usuario= ?, nombre=?, primerapellido=?, "
				+ "segundoapellido=?,numerosecreto=? where dni=?";
		PreparedStatement pst= conn.prepareStatement(query);
		pst.setString(1, propietario.getUsuario());
		pst.setString(2, propietario.getNombre());
		pst.setString(3, propietario.getPrimerapellido());
		pst.setString(4, propietario.getSegundoapellido());
		pst.setString(5, propietario.getNumerosecreto());
		pst.setString(6, propietario.getDni());
		pst.executeUpdate();
		pst.close();
		conn.close();
		
		
		
	}
	
	public void eliminarPropietario(Propietarios propietario) throws SQLException {
		
		String query= "delete from propietarios where dni=? "+ propietario.getDni()+";";
		Statement st= (Statement) conn.createStatement();
		st.executeQuery(query);
		st.close();
		conn.close();
		
	}
	
	public Propietario consultarPropietario() throws SQLException {
		
		Propietarios propietario = new Propietarios();
		String query= "Select * from propietarios where dni ="+ propietario.getDni()+ ";";
		Statement st= (Statement) conn.createStatement();
		ResultSet rs= st.executeQuery(query);
		while(rs.next()) {
			propietario.setDni(rs.getString("dni_propietario"));
						
		}
		return propietario;
		
	}
	
	
	
	
	
}
